import React, { createContext, useContext, useState, type ReactNode } from "react";
import type { Activity } from "../types/activity";
import { parseCSV } from "../utils/csvParser";

interface ActivityContextType {
  activities: Activity[];
  setActivities: React.Dispatch<React.SetStateAction<Activity[]>>;
  selectedActivity: Activity | null;
  setSelectedActivity: React.Dispatch<React.SetStateAction<Activity | null>>;
  importCSV: (csvData: string) => void;
  isLoading: boolean;
}

const ActivityContext = createContext<ActivityContextType | undefined>(undefined);

export const useActivity = () => {
  const context = useContext(ActivityContext);
  if (!context) {
    throw new Error("useActivity must be used within an ActivityProvider");
  }
  return context;
};

interface ActivityProviderProps {
  children: ReactNode;
}

// Sample data for initial load
const sampleData = `Running,2025-05-06 09:55:16,false,"Leiden Running","3.45","238","00:27:17","151","169","123","184","7:54","3:54","17","28","1.04","0.0","3,612","14.0","No","00:01:51.3","3","16.0","00:26:38","00:32:29","-25","-1"
Running,2025-05-06 09:17:41,false,"Leiden - Easy Run","4.47","269","00:30:12","149","183","147","170","6:46","5:13","2","17","1.00","0.0","4,556","15.0","No","00:05:00","4","24.0","00:28:48","00:35:06","-11","8"
Running,2025-05-05 13:02:42,false,"Leiden - Easy Run","8.15","525","00:53:00","166","188","153","210","6:30","5:19","25","22","1.02","0.0","8,200","17.0","No","00:00:11.5","9","24.0","00:51:48","01:00:43","-6","9"
Running,2025-05-04 10:44:00,false,"Leiden Running","12.48","773","01:27:26","162","186","152","180","7:00","5:23","33","40","0.94","0.0","13,410","15.0","No","00:03:18.5","13","22.0","01:26:42","01:41:18","-11","1"
Running,2025-05-02 13:45:04,false,"Leiden Running","3.85","260","00:25:05","170","191","155","169","6:31","5:32","13","6","0.99","0.0","3,914","23.0","No","00:05:29.5","4","29.0","00:24:50","00:29:23","-3","8"
Running,2025-05-02 13:01:17,false,"Leiden - Stride Repeats","4.53","300","00:30:06","172","192","148","214","6:39","4:19","6","16","1.01","0.0","4,504","23.0","No","00:00:01.8","22","28.0","00:28:17","00:31:03","-3","8"
Running,2025-05-01 19:59:29,false,"Leiden Running","5.04","331","00:29:18","183","201","158","188","5:49","4:33","4","8","1.09","0.0","4,616","24.0","No","00:00:22.2","13","28.0","00:28:57","00:40:42","-10","-1"
Running,2025-05-01 19:41:19,false,"Leiden - Benchmark Run","1.98","104","00:11:39","152","190","157","165","5:53","4:49","--","7","1.08","0.0","1,826","26.0","No","00:02:00","4","28.0","00:11:39","00:11:45","1","8"
Running,2025-04-30 17:56:45,false,"Leiden Running","7.32","550","00:49:19","180","198","153","167","6:44","5:36","25","21","0.97","0.0","7,536","24.0","No","00:02:07.7","8","30.0","00:49:02","00:53:27","2","13"
Running,2025-04-29 14:58:15,false,"Leiden - W1 Tue Easy Run","8.76","530","00:59:09","154","182","149","167","6:45","5:29","60","19","0.99","0.0","8,956","24.0","No","00:05:17.7","9","28.0","00:56:35","01:10:55","3","15"
Running,2025-04-28 20:58:38,false,"Leiden Running","5.04","362","00:31:28","178","194","155","170","6:15","4:44","47","20","1.03","0.0","4,942","19.0","No","00:00:13.4","6","29.0","00:31:19","00:33:14","-11","8"
Running,2025-04-26 07:43:35,false,"Leiden Running","6.51","455","00:44:34","163","191","153","245","6:51","5:34","4","25","0.96","0.0","6,828","14.0","No","00:03:38.5","7","29.0","00:43:49","00:51:35","-59","-33"
Running,2025-04-19 18:34:56,false,"Leiden Running","13.95","959","01:44:36","165","189","153","167","7:30","5:24","33","36","0.87","0.0","16,066","14.0","No","00:06:41.9","14","24.0","01:44:00","02:04:31","4","17"
Running,2025-04-18 18:18:56,false,"Leiden Running","10.97","695","01:13:57","157","180","154","169","6:44","5:21","47","34","0.96","0.0","11,474","18.0","No","00:06:13.6","11","26.0","01:13:21","01:16:41","-5","9"
Running,2025-04-17 07:15:08,false,"Leiden Running","6.61","495","00:46:03","174","191","156","167","6:58","4:56","7","29","0.92","0.0","7,214","15.0","No","00:04:23.6","7","29.0","00:45:55","00:47:45","-56","-33"
Running,2025-04-16 17:28:28,false,"Leiden Running","5.76","390","00:37:14","165","192","157","169","6:28","5:14","55","26","0.99","0.0","5,856","15.0","No","00:05:03.1","6","25.0","00:37:03","00:37:55","-14","8"
Running,2025-04-14 17:33:04,false,"Leiden Running","6.46","383","00:43:05","147","175","156","169","6:40","5:09","20","17","0.96","0.0","6,758","19.0","No","00:02:56.8","7","25.0","00:42:45","00:53:05","-4","8"
Running,2025-04-11 16:05:04,false,"Leiden Running","9.73","713","01:13:24","166","193","144","172","7:32","5:27","19","23","0.92","0.0","10,876","19.0","No","00:05:32.8","10","25.0","01:12:04","01:32:24","-39","-25"
Running,2025-04-04 15:27:18,false,"Leiden Running","5.15","422","00:38:33","170","197","137","190","7:29","4:27","18","35","0.98","0.0","5,454","23.0","No","00:00:58.2","6","29.0","00:38:07","00:44:11","-14","5"
Running,2025-04-04 15:03:02,false,"Leiden Running","1.87","98","00:12:37","127","155","148","200","6:44","5:45","2","3","1.01","0.0","1,898","25.0","No","00:06:12.6","2","27.0","00:12:25","00:13:01","15","18"
Running,2025-04-02 17:28:39,false,"Leiden Running","4.80","257","00:32:36","132","145","147","213","6:48","5:04","33","40","1.00","0.0","4,890","19.0","No","00:05:49.2","5","26.0","00:32:18","00:42:44","-34","-21"
Running,2025-03-29 16:31:51,false,"Leiden Running","7.39","398","00:47:35","143","164","156","229","6:26","5:08","48","22","0.99","0.0","7,418","13.0","No","00:02:36.9","8","21.0","00:47:00","00:53:44","-5","4"
Running,2025-03-27 18:50:50,false,"Leiden Running","1.96","126","00:14:38","143","157","153","167","7:29","6:31","6","4","0.87","0.0","2,250","14.0","No","00:07:07.7","2","15.0","00:14:26","00:17:29","-6","-3"
Running,2025-03-27 18:28:59,false,"Leiden - yaso 800","2.87","196","00:20:37","153","174","148","170","7:12","5:39","1","6","0.93","0.0","3,124","15.0","No","00:03:07.2","5","20.0","00:19:54","00:20:37","-7","-1"
Running,2025-03-27 16:59:32,false,"Leiden Running","10.02","736","01:10:11","172","193","156","167","7:00","5:11","13","22","0.92","0.0","10,964","17.0","No","00:00:20.2","11","25.0","01:09:56","01:14:59","-17","-5"
Running,2025-03-25 17:42:41,false,"Leiden Running","0.70","46","00:04:56.0","151","162","142","169","7:02","6:00","45","1","1.00","0.0","744","12.0","No","00:04:56.0","1","12.0","00:04:56.0","00:04:56.0","21","23"
Running,2025-03-25 17:25:35,false,"Leiden Running","2.06","122","00:14:27","139","155","154","167","7:00","5:44","4","3","0.93","0.0","2,236","12.0","No","00:00:24.0","3","14.0","00:14:25","00:15:10","-20","-17"
Running,2025-03-25 16:43:56,false,"Leiden Running","4.49","278","00:29:22","149","186","154","177","6:32","5:21","2","24","0.99","0.0","4,524","12.0","No","00:03:58.9","5","26.0","00:29:09","00:34:20","-35","-11"
Running,2025-03-21 18:43:58,false,"Leiden Running","2.04","162","00:14:02","181","189","141","170","6:53","5:10","3","3","1.03","0.0","2,074","22.0","No","00:00:14.8","3","23.0","00:13:58","00:14:31","-7","-4"
Running,2025-03-21 18:07:05,false,"Leiden Running","5.01","349","00:31:36","171","191","153","221","6:19","4:49","17","21","1.04","0.0","4,852","21.0","No","00:00:04.3","6","26.0","00:31:18","00:36:09","-6","9"
Running,2025-03-16 16:26:58,false,"Leiden Running","7.55","438","00:48:07","150","167","156","169","6:22","5:05","27","52","1.01","0.0","7,472","11.0","No","00:03:27.8","8","26.0","00:47:50","00:55:59","-36","-12"
Running,2025-03-13 18:46:15,false,"Leiden Running","2.82","173","00:18:29","153","186","158","172","6:33","4:59","2","14","0.97","0.0","2,916","11.0","No","00:05:49.4","3","23.0","00:18:17","00:22:08","-23","-6"
Running,2025-03-09 15:23:00,false,"The Hague Running","9.98","608","01:04:58","159","195","162","179","6:31","5:02","31","26","0.95","0.0","10,520","20.0","No","00:05:33.1","10","25.0","01:04:54","01:05:06","-15","--"
Running,2025-03-06 19:01:27,false,"Leiden Running","7.39","477","00:51:14","161","190","158","176","6:56","5:42","6","19","0.92","0.0","8,094","14.0","No","00:02:34.4","8","26.0","00:50:55","00:54:29","-27","-9"
Running,2025-03-04 18:03:21,false,"Leiden - fartlek w2 d2","7.50","523","00:55:10","168","190","156","196","7:22","4:39","8","24","0.87","0.0","8,568","11.0","No","00:00:10.0","27","24.0","00:54:19","00:55:13","-21","-2"
Running,2025-03-02 15:30:17,false,"Leiden Running","17.13","1,246","02:05:25","176","192","157","220","7:19","5:08","28","36","0.87","0.0","19,724","11.0","No","00:00:56.3","18","25.0","02:04:56","02:09:29","-23","-8"
Running,2025-02-27 15:57:38,false,"Leiden - speedplay-str ma","8.56","509","01:00:15","154","170","149","186","7:02","4:19","58","86","0.99","0.0","9,266","7.0","No","00:00:14.8","27","25.0","00:58:31","01:00:22","-42","9"
Running,2025-02-25 17:58:43,false,"Leiden Running","7.62","518","00:51:19","173","189","159","167","6:44","5:12","9","28","0.93","0.0","8,168","17.0","No","00:04:26.4","8","25.0","00:51:07","00:52:22","-32","-10"
Running,2025-02-23 17:09:20,false,"Leiden Running","9.95","750","01:10:52","180","193","158","173","7:08","5:37","16","33","0.89","0.0","11,184","15.0","No","00:06:42.3","10","23.0","01:10:22","01:11:57","-22","-6"
Running,2025-02-21 14:05:13,false,"Leiden Running","6.33","448","00:42:44","171","195","155","170","6:45","5:25","21","15","0.96","0.0","6,674","20.0","No","00:02:19.2","7","25.0","00:42:37","00:43:51","-1","9"
Running,2025-02-19 16:55:39,false,"Leiden Running","6.93","483","00:44:46","175","192","159","208","6:28","5:27","13","29","0.98","0.0","7,062","13.0","No","00:06:20.0","7","23.0","00:44:20","00:47:25","-27","-2"
Running,2025-02-15 16:53:56,false,"Leiden Running","13.74","925","01:35:26","169","189","160","171","6:57","4:51","19","31","0.90","0.0","15,256","8.0","No","00:05:27.8","14","25.0","01:34:58","01:37:56","-18","2"
Running,2025-02-13 16:17:45,false,"Leiden Running","6.33","406","00:41:26","159","187","160","170","6:32","5:31","11","28","0.96","0.0","6,626","10.0","No","00:02:08.9","7","23.0","00:41:06","00:43:38","-34","-11"
Running,2025-02-11 17:02:42,false,"Leiden Running","7.52","508","00:51:44","165","182","158","233","6:53","5:36","10","29","0.92","0.0","8,174","9.0","No","00:03:42.9","8","26.0","00:51:19","00:52:45","-32","-8"
Running,2025-02-08 11:21:20,false,"Leiden Running","2.14","148","00:16:14","162","174","151","210","7:34","5:57","4","3","0.88","0.0","2,434","11.0","No","00:00:55.7","3","12.0","00:16:06","00:16:38","-40","-36"
Running,2025-02-08 10:23:41,false,"Leiden Running","6.38","379","00:41:05","156","188","161","180","6:26","4:21","8","23","0.96","0.0","6,610","12.0","No","00:00:59.9","11","27.0","00:40:45","00:54:07","-41","-14"
Running,2025-02-06 18:12:09,false,"Leiden Running","7.45","544","00:48:36","178","191","160","172","6:32","5:34","9","28","0.96","0.0","7,766","17.0","No","00:02:55.1","8","28.0","00:48:14","00:50:28","-15","8"
Running,2025-02-05 17:11:52,false,"Leiden Running","6.27","441","00:41:51","169","187","160","169","6:40","5:40","8","22","0.94","0.0","6,674","21.0","No","00:01:44.8","7","27.0","00:41:36","00:42:45","-46","-24"
Running,2025-02-04 18:28:18,false,"Leiden Running","3.11","215","00:22:09","158","185","157","176","7:07","5:49","4","14","0.90","0.0","3,508","21.0","No","00:00:47.7","4","28.0","00:22:02","00:22:48","-15","-1"
Running,2025-02-02 16:04:09,false,"Leiden - W1 Sun Long Run","17.85","1,174","02:04:49","165","191","155","201","6:59","5:44","46","51","0.92","0.0","19,560","7.0","No","00:00:08.6","22","27.0","01:58:52","02:12:44","-23","9"
Running,2025-02-01 19:42:28,false,"Leiden Running","5.46","346","00:35:45","155","183","161","172","6:33","5:13","8","23","0.95","0.0","5,744","10.0","No","00:02:53.6","6","25.0","00:35:34","00:37:46","-27","-6"
Running,2025-01-31 16:58:42,false,"Leiden - W1 Fri Intervals","8.60","566","01:00:55","156","175","148","186","7:05","4:19","10","30","0.99","0.0","9,256","9.0","No","00:00:35.7","15","26.0","00:56:22","01:03:36","-35","-9"
Running,2025-01-28 17:15:58,false,"Leiden Running","7.49","497","00:55:04","152","168","159","221","7:21","5:18","16","32","0.86","0.0","8,728","12.0","No","00:03:47.1","8","25.0","00:54:50","00:57:28","-38","-18"
Running,2025-01-24 16:43:07,false,"Leiden Running","10.04","528","01:08:47","133","156","159","172","6:51","5:39","18","43","0.92","0.0","10,914","12.0","No","00:00:16.1","11","25.0","01:08:06","01:11:29","-46","-14"
Running,2025-01-20 18:18:46,false,"Leiden Running","9.56","668","01:03:09","169","188","160","169","6:36","5:35","11","35","0.94","0.0","10,116","9.0","No","00:03:37.9","10","28.0","01:02:46","01:04:24","-40","-13"
Running,2025-01-18 18:46:42,false,"Leiden Running","11.98","862","01:23:30","172","193","160","172","6:58","5:51","27","65","0.90","0.0","13,376","17.0","No","00:06:33.7","12","26.0","01:23:08","01:26:03","-56","-0"
Running,2025-01-16 17:36:59,false,"Leiden Running","6.91","466","00:45:43","162","189","160","169","6:37","5:14","30","29","0.95","0.0","7,288","10.0","No","00:06:03.6","7","25.0","00:45:24","00:47:27","-16","12"
Running,2025-01-15 08:47:18,false,"Leiden - Goal Pace Repeat","2.26","157","00:18:18","146","162","135","203","8:07","5:22","41","4","0.93","0.0","2,542","12.0","No","00:00:12.0","21","15.0","00:16:58","00:22:59","7","13"
Running,2025-01-15 08:11:38,false,"Leiden Running","4.41","290","00:32:48","145","163","155","172","7:26","6:05","15","30","0.86","0.0","5,124","15.0","No","00:03:59.6","5","27.0","00:32:28","00:34:48","-30","-8"
Running,2025-01-14 16:48:03,false,"Leiden - threasholdDD1","6.36","364","00:44:21","140","152","151","174","6:58","4:27","101","16","0.96","0.0","6,808","11.0","No","00:01:00","14","16.0","00:42:41","00:47:11","-29","69"
Running,2025-01-14 16:38:02,false,"Leiden - Benchmark Run","1.45","74","00:09:04.0","133","149","151","173","6:15","5:21","--","17","1.06","0.0","1,378","16.0","No","00:00:04.0","4","28.0","00:08:35","00:09:04.0","-115","-97"
Running,2025-01-14 09:29:00,false,"Leiden Running","3.57","233","00:24:26","153","176","157","169","6:51","5:22","5","22","0.93","0.0","3,862","9.0","No","00:04:14.3","4","26.0","00:24:15","00:27:46","-113","-86"
Running,2025-01-12 14:23:43,false,"Leiden Running","10.91","688","01:17:36","150","170","158","208","7:07","5:18","18","33","0.89","0.0","12,210","10.0","No","00:06:17.2","11","25.0","01:17:04","01:23:51","-114","-96"
Running,2025-01-10 18:46:28,false,"Leiden Running","2.86","181","00:19:17","148","176","157","174","6:44","5:42","2","18","0.94","0.0","3,048","18.0","No","00:05:49.0","3","26.0","00:19:10","00:19:33","-117","-99"
Running,2025-01-09 18:20:17,false,"Leiden Running","7.17","390","00:48:42","135","149","158","180","6:48","5:13","13","39","0.93","0.0","7,712","4.0","No","00:01:13.8","8","24.0","00:48:09","00:52:49","-134","-103"
Running,2025-01-07 17:47:02,false,"Leiden Running","6.25","405","00:42:05","150","166","158","174","6:44","5:27","6","31","0.94","0.0","6,628","11.0","No","00:01:31.5","7","26.0","00:41:30","00:45:57","-126","-95"
Running,2025-01-05 16:06:59,false,"Leiden Running","5.84","361","00:38:59","148","167","156","169","6:41","5:01","39","63","0.96","0.0","6,086","13.0","No","00:05:30.4","6","27.0","00:38:23","00:41:35","-27","4"
Running,2025-01-03 05:51:34,false,"Leiden Running","6.97","447","00:50:47","151","175","161","172","7:17","5:49","43","41","0.85","0.0","8,154","7.0","No","00:06:36.8","7","29.0","00:50:41","00:53:33","-16","9"
Running,2025-01-02 08:19:37,false,"Leiden Running","7.35","404","00:48:57","136","151","161","174","6:39","5:39","9","39","0.93","0.0","7,840","6.0","No","00:02:30.6","8","29.0","00:48:36","00:52:55","-44","-6"
Running,2025-01-01 18:17:10,false,"Leiden Running","2.60","111","00:16:24","121","142","161","174","6:18","4:13","6","37","0.99","0.0","2,630","9.0","No","00:03:39.7","3","24.0","00:16:18","00:16:32","-16","8"
Running,2024-12-31 16:55:40,false,"Leiden Running","8.28","454","00:55:42","139","163","158","169","6:43","4:53","99","129","0.94","0.0","8,744","9.0","No","00:01:46.4","9","25.0","00:55:04","00:58:15","-12","88"
Running,2024-12-30 18:04:18,false,"Leiden Running","5.17","333","00:34:05","154","168","157","170","6:36","5:08","22","35","0.97","0.0","5,340","14.0","No","00:01:04.2","6","24.0","00:33:55","00:34:21","-19","-1"
Running,2024-12-29 11:24:30,false,"Leiden Running","18.83","1,189","02:18:53","154","174","156","218","7:22","5:21","35","48","0.87","0.0","21,960","9.0","No","00:06:15.9","19","25.0","02:18:23","02:30:29","-23","-7"
Running,2024-12-28 08:29:31,false,"Leiden Running","4.21","235","00:27:47","140","163","160","182","6:36","5:30","3","28","0.95","0.0","4,436","8.0","No","00:01:22.0","5","29.0","00:27:27","00:28:41","-38","-12"
Running,2024-12-25 12:12:40,false,"Riga Running","6.12","418","00:41:56","157","178","157","235","6:51","5:36","24","32","0.93","0.0","6,570","14.0","No","00:00:54.1","7","24.0","00:41:47","00:42:39","-16","6"
Running,2024-12-24 12:05:38,false,"Riga Running","8.70","640","00:58:47","--","--","159","182","6:45","4:31","13","50","0.93","0.0","9,322","10.0","No","00:04:36.9","9","22.0","00:58:29","01:02:37","-29","6"
Running,2024-12-23 10:49:48,false,"Riga Running","7.61","492","00:53:11","152","169","159","218","6:59","5:38","21","44","0.90","0.0","8,444","10.0","No","00:04:24.7","8","25.0","00:53:03","00:53:28","-22","5"
Running,2024-12-22 14:10:09,false,"Riga Running","7.37","461","00:52:12","145","160","158","186","7:05","5:04","29","40","0.89","0.0","8,332","12.0","No","00:02:25.5","8","27.0","00:51:43","00:55:40","-21","5"
Running,2024-12-18 18:12:30,false,"Leiden Running","7.59","543","00:51:53","165","189","154","190","6:50","4:10","49","54","0.95","0.0","8,038","16.0","No","00:04:03.1","8","25.0","00:51:11","00:54:39","-100","-81"
Running,2024-12-16 18:15:50,false,"Leiden Running","6.82","381","00:45:37","139","151","159","174","6:41","5:06","17","35","0.94","0.0","7,240","13.0","No","00:05:34.8","7","25.0","00:45:25","00:46:16","-95","-73"
Running,2024-12-08 08:39:59,false,"Nyamira Running","15.19","1,062","02:07:18","155","189","142","212","8:23","4:32","269","315","0.84","0.0","18,178","20.0","No","00:00:01.6","39","30.0","02:05:54","02:58:49","1,962","2,133"
Running,2024-12-06 13:00:13,false,"Nyamira Running","7.86","571","01:05:28","155","185","142","207","8:20","5:15","179","166","0.84","0.0","9,510","24.0","No","00:07:15.7","8","34.0","01:04:31","01:21:16","1,909","1,985"
Running,2024-12-04 16:59:14,false,"Nyamira Running","0.66","30","00:03:57.3","135","150","146","178","5:57","4:33","10","15","1.15","0.0","612","17.0","No","00:00:01.5","8","18.0","00:03:43.7","00:05:20.8","1,870","1,895"
Running,2024-12-04 15:45:10,false,"Nyamira Running","7.60","591","01:00:55","169","189","147","196","8:01","5:44","159","270","0.85","0.0","8,964","17.0","No","00:04:37","8","30.0","01:00:39","01:11:06","1,765","1,943"
Running,2024-12-03 16:39:30,false,"Nyamira Running","5.58","432","00:42:31","170","191","149","169","7:37","5:28","79","155","0.88","0.0","6,366","20.0","No","00:04:16.4","6","22.0","00:42:12","00:49:12","1,896","1,941"
Running,2024-12-01 12:52:26,false,"Nyamira Running","3.71","271","00:28:11","163","178","146","184","7:36","5:38","73","85","0.90","0.0","4,084","25.0","No","00:05:14.3","4","29.0","00:27:46","00:38:01","1,904","1,945"
Running,2024-12-01 12:28:02,false,"Nyamira Running","1.44","130","00:16:48","138","154","73","188","11:41","3:31","23","20","0.88","0.0","1,246","25.0","No","00:00:19.8","21","28.0","00:07:18.8","00:17:29","1,922","1,932"
Running,2024-12-01 12:15:39,false,"Nyamira Running","1.01","69","00:07:24.6","147","166","156","203","7:20","6:07","30","2","0.87","0.0","1,140","24.0","No","00:00:00.8","3","26.0","00:07:12.6","00:09:30.3","1,913","1,938"
Running,2024-11-30 10:18:27,false,"Nyamira Running","10.18","707","01:28:39","152","189","137","210","8:42","5:22","221","306","0.84","0.0","12,434","22.0","No","00:03:46.4","7","29.0","01:27:46","02:08:52","1,913","2,127"
Running,2024-11-29 15:21:26,false,"Nyamira Running","0.59","22","00:02:49.8","141","153","140","186","4:48","3:46","--","126","1.52","0.0","436","25.0","No","00:00:14.7","7","26.0","00:02:45.4","00:05:35.5","1,756","1,894"
Running,2024-11-29 14:12:54,false,"Nyamira Running","6.95","576","00:56:03","169","210","139","221","8:04","3:56","159","160","0.89","0.0","7,898","22.0","No","00:03:35.7","5","27.0","00:55:38","01:02:19","1,909","1,995"
Running,2024-11-28 14:14:28,false,"Nyamira Running","0.57","23","00:03:09.3","133","160","155","210","5:30","4:30","153","10","1.18","0.0","484","19.0","No","00:00:10.6","5","20.0","00:03:05.9","00:08:00.4","1,872","1,885"
Running,2024-11-28 12:44:14,false,"Nyamira Running","7.25","486","01:00:51","145","168","140","186","8:24","5:39","181","241","0.85","0.0","8,594","19.0","No","00:05:58.6","5","27.0","01:00:19","01:04:47","1,811","1,966"
Running,2024-11-27 09:41:38,false,"Nyamira Running","4.38","272","00:37:09","136","155","138","167","8:29","5:46","27","106","0.85","0.0","5,198","22.0","No","00:10:19","3","23.0","00:36:31","00:45:43","1,860","1,930"
Running,2024-11-27 08:31:40,false,"Nyamira - W2 Wed Tempo - R","4.34","245","00:35:11","130","151","132","177","8:06","4:27","86","79","0.93","0.0","5,040","20.0","No","00:01:36.7","10","24.0","00:32:08","00:45:01","1,877","1,938"
Running,2024-11-26 14:12:56,false,"Nyamira - Speed Play","5.18","441","00:43:25","166","208","132","205","8:23","4:29","339","178","0.90","0.0","5,902","28.0","No","00:00:30","15","34.0","00:40:10","00:54:08","1,888","1,981"
Running,2024-11-24 13:06:33,false,"Nyamira Running","5.30","348","00:36:25","162","192","152","176","6:52","4:15","192","53","0.95","0.0","5,512","25.0","No","00:00:27.2","14","31.0","00:35:41","01:06:18","1,913","2,006"
Trail Running,2024-11-23 17:34:18,false,"Nyamira Trail Running","3.08","212","00:22:25","151","166","148","163","7:17","5:08","46","66","0.93","0.0","3,388","19.0","No","00:10:27","2","23.0","00:21:53","00:23:32","1,890","1,944"
Trail Running,2024-11-20 14:06:58,false,"Nyamira Trail Running","8.70","689","01:24:02","155","199","124","239","9:39","4:16","267","204","0.83","0.0","10,718","22.0","No","00:05:36.0","6","31.0","01:20:18","01:24:02","1,894","1,964"
Trail Running,2024-11-17 10:14:28,false,"Nyamira Trail Running","8.26","721","01:17:07","163","196","122","187","9:20","5:13","226","415","0.88","0.0","9,816","25.0","No","00:01:29.8","6","31.0","01:11:05","01:20:18","1,922","2,192"
Running,2024-11-17 09:49:06,false,"Nyamira Running","1.61","203","00:20:14","165","195","115","167","12:32","6:26","147","28","0.69","0.0","2,406","26.0","No","00:00:04.3","2","30.0","00:19:59","00:25:05","2,025","2,148"
Running,2024-11-15 15:33:03,false,"Nyamira Running","7.55","421","01:03:37","127","147","137","226","8:25","5:55","54","333","0.86","0.0","8,882","22.0","No","00:09:50.5","5","25.0","01:03:18","01:09:20","1,890","2,162"
Running,2024-11-15 14:47:49,false,"Nyamira - Hill Repeats","1.82","136","00:25:40","120","149","87","193","14:06","4:17","79","18","0.80","0.0","2,328","25.0","No","00:00:02.7","33","29.0","00:16:58","00:30:25","2,012","2,098"
Running,2024-11-12 15:48:17,false,"Nyamira Running","11.88","827","01:55:49","153","175","127","215","9:45","5:32","194","260","0.80","0.0","15,434","17.0","No","00:05:12.2","8","24.0","01:54:43","02:09:58","1,974","2,142"
Running,2024-11-07 18:18:06,false,"Nyamira Running","1.00","58","00:08:14.7","143","156","139","226","8:15","6:38","--","46","0.87","0.0","1,184","18.0","No","00:08:14.7","1","18.0","00:08:10","00:11:18","1,869","1,939"
Running,2024-11-07 16:03:36,false,"Nyamira Running","14.77","1,004","02:03:54","160","186","144","218","8:23","5:09","249","294","0.83","0.0","18,060","17.0","No","00:02:20.3","10","26.0","02:03:10","02:13:27","1,972","2,158"
Running,2024-11-06 17:56:38,false,"Nyamira Running","2.53","168","00:17:07","173","183","155","226","6:46","4:50","--","125","0.95","0.0","2,644","23.0","No","00:06:35.1","2","24.0","00:17:04","00:17:37","1,884","2,014"
Running,2024-11-06 16:51:10,false,"Nyamira Running","6.75","571","00:56:02","175","189","143","167","8:18","5:19","157","170","0.84","0.0","8,156","22.0","No","00:01:49.1","5","28.0","00:55:23","00:59:17","1,955","2,122"
Running,2024-11-04 17:44:47,false,"Easy cooldown ","0.32","21","00:02:32.1","140","153","150","158","7:48","6:30","8","1","0.85","0.0","374","20.0","No","00:02:32.1","1","21.0","00:02:31","00:02:39.1","1,881","1,889"
Running,2024-11-04 17:07:33,false,"Nyamira Running","2.69","178","00:21:26","150","162","145","210","7:59","5:00","32","32","0.86","0.0","3,174","20.0","No","00:08:54.8","2","24.0","00:21:13","00:28:18","1,879","1,886"
Running,2024-11-02 16:44:22,false,"Nyamira Running","11.91","918","01:36:30","170","194","142","248","8:06","5:34","186","361","0.87","0.0","14,008","21.0","No","00:04:38.3","8","28.0","01:35:27","01:49:22","1,852","2,131"
Running,2024-11-01 18:00:38,false,"Nyamira Running","1.70","102","00:12:21","135","161","151","160","7:15","5:33","15","14","0.91","0.0","1,880","22.0","No","00:00:36.3","2","26.0","00:12:14","00:12:36","1,885","1,891"
Running,2024-10-31 18:09:57,false,"Nyamira Running","1.66","114","00:12:18","169","191","156","165","7:26","6:31","12","14","0.86","0.0","1,906","20.0","No","00:00:20.7","2","23.0","00:12:17","00:12:30","1,884","1,889"
Running,2024-10-31 18:00:01,false,"Nyamira - Benchmark Run","1.15","75","00:09:11.9","143","162","137","167","7:59","6:07","6","19","0.91","0.0","1,334","23.0","No","00:00:11.9","4","28.0","00:08:58","00:09:11.9","1,874","1,892"
Running,2024-10-29 14:56:46,false,"Nyamira Running","2.54","235","00:22:47","175","189","122","226","8:58","4:53","71","60","0.90","0.0","2,970","28.0","No","00:05:52.6","2","33.0","00:21:56","00:27:34","2,013","2,093"
Running,2024-10-29 13:47:04,false,"Nyamira - tempo run workou","5.15","461","00:44:35","172","192","118","207","8:39","4:29","126","124","0.97","0.0","5,564","29.0","No","00:03:10.0","5","33.0","00:41:18","00:53:43","2,009","2,114"
Running,2024-10-27 18:19:42,false,"Nyamira - Speed Repeats","2.07","125","00:17:11","135","155","122","207","8:19","3:39","13","20","1.00","0.0","2,190","21.0","No","00:00:07.4","16","25.0","00:14:25","00:18:18","1,872","1,885"
Running,2024-10-26 17:21:56,false,"Nyamira - Run Walk RunÂ®","6.46","509","01:00:45","162","187","131","218","9:24","4:51","137","154","0.80","0.0","8,242","23.0","No","00:05:17.4","5","27.0","00:55:43","01:00:46","1,992","2,136"
Running,2024-10-25 14:19:03,false,"Nyamira Running","5.77","493","00:46:46","181","195","135","218","8:06","4:03","85","204","0.91","0.0","6,622","23.0","No","00:06:02.1","4","35.0","00:46:11","00:50:47","2,032","2,197"
Running,2024-10-25 13:48:09,false,"Nyamira Running","1.68","158","00:16:36","159","196","132","184","9:52","6:10","116","1","0.76","0.0","2,274","29.0","No","00:00:46.4","2","33.0","00:16:00","00:22:43","2,008","2,127"
`;

export const ActivityProvider = ({ children }: ActivityProviderProps) => {
  const [activities, setActivities] = useState<Activity[]>(() => {
    return parseCSV(sampleData);
  });
  const [selectedActivity, setSelectedActivity] = useState<Activity | null>(null);
  const [isLoading, setIsLoading] = useState(false);

  const importCSV = (csvData: string) => {
    setIsLoading(true);
    try {
      const parsedActivities = parseCSV(csvData);
      setActivities(parsedActivities);
      setSelectedActivity(null);
    } catch (error) {
      console.error("Error importing CSV:", error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <ActivityContext.Provider
      value={{
        activities,
        setActivities,
        selectedActivity,
        setSelectedActivity,
        importCSV,
        isLoading
      }}
    >
      {children}
    </ActivityContext.Provider>
  );
};